version: '3.8'

services:
  mining-client-simulation-haskell:
    image: ${HASKELL_IMAGE:-salamaashoush/chainweb-mining-client:latest}
    container_name: mining-client-simulation-haskell
    command:
      - --worker
      - simulation
      - --node
      - chainweb-no-pow:1848
      - --public-key
      - ${MINER_PUBLIC_KEY:-f89ef46927f506c70b6a58fd322450a936311dc6ac91f4ec3d8ef949608dbf1f}
      - --account
      - ${MINER_ACCOUNT:-k:f89ef46927f506c70b6a58fd322450a936311dc6ac91f4ec3d8ef949608dbf1f}
      - --hash-rate
      - "1000000"
      - --log-level
      - info
    depends_on:
      chainweb-no-pow:
        condition: service_healthy
    networks:
      - chainweb-test
    volumes:
      - test-results:/results
    environment:
      - TEST_MODE=simulation
      - IMPLEMENTATION=haskell

  mining-client-simulation-rust:
    image: ${RUST_IMAGE:-salamaashoush/chainweb-mining-client-rs:latest}
    container_name: mining-client-simulation-rust
    command:
      - --worker
      - simulation
      - --node
      - chainweb-no-pow:1848
      - --public-key
      - ${MINER_PUBLIC_KEY:-f89ef46927f506c70b6a58fd322450a936311dc6ac91f4ec3d8ef949608dbf1f}
      - --account
      - ${MINER_ACCOUNT:-k:f89ef46927f506c70b6a58fd322450a936311dc6ac91f4ec3d8ef949608dbf1f}
      - --hash-rate
      - "1000000"
      - --log-level
      - info
    depends_on:
      chainweb-no-pow:
        condition: service_healthy
    networks:
      - chainweb-test
    volumes:
      - test-results:/results
    environment:
      - TEST_MODE=simulation
      - IMPLEMENTATION=rust